[build]
publish = "public/"
command = "yarn build"

[build.environment]
NODE_VERSION = "16"

NETLIFY_USE_YARN = "true"
YARN_VERSION = "3.1.1"
YARN_FLAGS = "--immutable"
YARN_ENABLE_GLOBAL_CACHE = "true"
YARN_GLOBAL_FOLDER = "/opt/buildhome/.yarn_cache"

[[plugins]]
package = "@netlify/plugin-gatsby"

[[redirects]]
from = "https://tedbyron.netlify.com/*"
to = "https://tedbyron.com/:splat"
status = 301
force = true

[[redirects]]
from = "https://tedbyron.netlify.app/*"
to = "https://tedbyron.com/:splat"
status = 301
force = true

[[headers]]
for = "*.js"
[headers.values]
cache-control = "public, max-age=31536000, immutable"

[[headers]]
for = "sw.js"
[headers.values]
cache-control = "public, max-age=0, must-revalidate"

[[headers]]
for = "*.html"
[headers.values]
cache-control = "public, max-age=0, must-revalidate"

[[headers]]
for = "public/page-data/"
[headers.values]
cache-control = "public, max-age=0, must-revalidate"

[[headers]]
for = "public/static/"
[headers.values]
cache-control = "public, max-age=31536000, immutable"
